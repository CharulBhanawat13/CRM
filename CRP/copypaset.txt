
select norg_id ,count(*)
from tbl_visitplan
where norg_id IN (SELECT norg_id
from tbl_organisation
WHERE norg_group_id=2)
 group by norg_id

--------------------------

CREATE TEMPORARY TABLE tbl_visitCount
select norg_id ,count(*) AS nofVisit
from tbl_visitplan
where norg_id IN (
SELECT norg_id FROM tbl_organisation
WHERE norg_group_id=2)
group by norg_id;



CREATE TEMPORARY TABLE tbl_callListCount
select norg_id ,count(*) AS noOFCallList
from tbl_callList
where norg_id IN (
SELECT norg_id FROM tbl_organisation
WHERE norg_group_id=2)
group by norg_id;


CREATE TEMPORARY TABLE tbl_tourCount
select norg_id ,count(*) AS noOfTour
from tbl_tour
where norg_id IN (
SELECT norg_id FROM tbl_organisation
WHERE norg_group_id=2)
group by norg_id;

select o.norg_id ,o.corg_name ,nofVisit,noOFCallList,noOfTour from tbl_organisation AS o
LEFT JOIN tbl_visitCount AS vc
ON vc.norg_id=o.norg_id
LEFT JOIN tbl_callListCount AS CL
ON CL.norg_id=o.norg_id
LEFT JOIN tbl_tourCount AS TC
ON TC.norg_id=o.norg_id
where o.norg_group_id=2;